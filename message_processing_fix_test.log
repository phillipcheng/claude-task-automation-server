/Users/bytedance/python/claudeserver/app/main.py:37: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
INFO:     Started server process [49222]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
Database initialized: mysql+pymysql://root:sitebuilder@localhost/claudesys
INFO:     127.0.0.1:51323 - "POST /api/v1/tasks/by-name/add_scene_event_codes_to_stra/set-input HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:51667 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra HTTP/1.1" 200 OK
INFO:     127.0.0.1:51667 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:51667 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra/conversation HTTP/1.1" 200 OK
INFO:     127.0.0.1:51796 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra/status HTTP/1.1" 200 OK
ğŸ” DEBUG: Adding user input to queue for task 8d71a584-a288-4993-bca2-c445249c7d1a (add_scene_event_codes_to_stra): 'what is the current status...'
ğŸ” UserInputManager DEBUG: Starting add_user_input for task 8d71a584-a288-4993-bca2-c445249c7d1a, use_separate_session=True
ğŸ” UserInputManager DEBUG: Using separate database session
ğŸ” UserInputManager DEBUG: Found task add_scene_event_codes_to_stra
ğŸ” UserInputManager DEBUG: Current queue: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}]
ğŸ” UserInputManager DEBUG: Created input entry: {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'timestamp': '2025-10-25T13:30:53.515189', 'processed': False}
ğŸ” UserInputManager DEBUG: Current queue before append: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}]
ğŸ” UserInputManager DEBUG: Current queue after append: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'timestamp': '2025-10-25T13:30:53.515189', 'processed': False}]
ğŸ” UserInputManager DEBUG: Set task.user_input_queue to: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'timestamp': '2025-10-25T13:30:53.515189', 'processed': False}] and flagged as modified
ğŸ” UserInputManager DEBUG: About to commit...
âœ… UserInputManager DEBUG: Commit successful
ğŸ” UserInputManager DEBUG: Post-commit verification - database shows queue: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}]
ğŸ” UserInputManager DEBUG: Closed separate database session
ğŸ” DEBUG: UserInputManager.add_user_input() returned: True
âœ… DEBUG: Successfully added user input to queue for task 8d71a584-a288-4993-bca2-c445249c7d1a with separate session
ğŸ” DEBUG: After UserInputManager commit - fresh query shows task.user_input_queue = [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}]
ğŸ” DEBUG: About to commit legacy field for task 8d71a584-a288-4993-bca2-c445249c7d1a
âœ… DEBUG: Legacy field commit completed for task 8d71a584-a288-4993-bca2-c445249c7d1a
INFO:     127.0.0.1:51796 - "POST /api/v1/tasks/by-name/add_scene_event_codes_to_stra/set-input HTTP/1.1" 200 OK
INFO:     127.0.0.1:51796 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra/conversation HTTP/1.1" 200 OK
INFO:     127.0.0.1:51849 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra HTTP/1.1" 200 OK
INFO:     127.0.0.1:51849 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra HTTP/1.1" 200 OK
INFO:     127.0.0.1:51849 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra HTTP/1.1" 200 OK
INFO:     127.0.0.1:51849 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra HTTP/1.1" 200 OK
INFO:     127.0.0.1:51849 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra HTTP/1.1" 200 OK
INFO:     127.0.0.1:51849 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:51849 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra/conversation HTTP/1.1" 200 OK
ğŸ” DEBUG: Adding user input to queue for task 8d71a584-a288-4993-bca2-c445249c7d1a (add_scene_event_codes_to_stra): 'Test message processing fix - this should be marke...'
ğŸ” UserInputManager DEBUG: Starting add_user_input for task 8d71a584-a288-4993-bca2-c445249c7d1a, use_separate_session=True
ğŸ” UserInputManager DEBUG: Using separate database session
ğŸ” UserInputManager DEBUG: Found task add_scene_event_codes_to_stra
ğŸ” UserInputManager DEBUG: Current queue: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}]
ğŸ” UserInputManager DEBUG: Created input entry: {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'timestamp': '2025-10-25T13:31:13.899523', 'processed': False}
ğŸ” UserInputManager DEBUG: Current queue before append: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}]
ğŸ” UserInputManager DEBUG: Current queue after append: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'timestamp': '2025-10-25T13:31:13.899523', 'processed': False}]
ğŸ” UserInputManager DEBUG: Set task.user_input_queue to: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'timestamp': '2025-10-25T13:31:13.899523', 'processed': False}] and flagged as modified
ğŸ” UserInputManager DEBUG: About to commit...
âœ… UserInputManager DEBUG: Commit successful
ğŸ” UserInputManager DEBUG: Post-commit verification - database shows queue: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}]
ğŸ” UserInputManager DEBUG: Closed separate database session
ğŸ” DEBUG: UserInputManager.add_user_input() returned: True
âœ… DEBUG: Successfully added user input to queue for task 8d71a584-a288-4993-bca2-c445249c7d1a with separate session
ğŸ” DEBUG: After UserInputManager commit - fresh query shows task.user_input_queue = [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}]
ğŸ” DEBUG: About to commit legacy field for task 8d71a584-a288-4993-bca2-c445249c7d1a
âœ… DEBUG: Legacy field commit completed for task 8d71a584-a288-4993-bca2-c445249c7d1a
INFO:     127.0.0.1:51957 - "POST /api/v1/tasks/by-name/add_scene_event_codes_to_stra/set-input HTTP/1.1" 200 OK
INFO:     127.0.0.1:52081 - "GET /api/v1/tasks/by-name/add_scene_event_codes_to_stra/input-queue-status HTTP/1.1" 200 OK
ğŸ” DEBUG: Adding user input to queue for task 8d71a584-a288-4993-bca2-c445249c7d1a (add_scene_event_codes_to_stra): 'Mark all previous messages as processed...'
ğŸ” UserInputManager DEBUG: Starting add_user_input for task 8d71a584-a288-4993-bca2-c445249c7d1a, use_separate_session=True
ğŸ” UserInputManager DEBUG: Using separate database session
ğŸ” UserInputManager DEBUG: Found task add_scene_event_codes_to_stra
ğŸ” UserInputManager DEBUG: Current queue: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}]
ğŸ” UserInputManager DEBUG: Created input entry: {'id': '58a16257-c417-42d5-96d8-66a009e0ceac', 'input': 'Mark all previous messages as processed', 'timestamp': '2025-10-25T13:34:50.439379', 'processed': False}
ğŸ” UserInputManager DEBUG: Current queue before append: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}]
ğŸ” UserInputManager DEBUG: Current queue after append: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}, {'id': '58a16257-c417-42d5-96d8-66a009e0ceac', 'input': 'Mark all previous messages as processed', 'timestamp': '2025-10-25T13:34:50.439379', 'processed': False}]
ğŸ” UserInputManager DEBUG: Set task.user_input_queue to: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}, {'id': '58a16257-c417-42d5-96d8-66a009e0ceac', 'input': 'Mark all previous messages as processed', 'timestamp': '2025-10-25T13:34:50.439379', 'processed': False}] and flagged as modified
ğŸ” UserInputManager DEBUG: About to commit...
âœ… UserInputManager DEBUG: Commit successful
ğŸ” UserInputManager DEBUG: Post-commit verification - database shows queue: [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}, {'id': '58a16257-c417-42d5-96d8-66a009e0ceac', 'input': 'Mark all previous messages as processed', 'processed': False, 'timestamp': '2025-10-25T13:34:50.439379'}]
ğŸ” UserInputManager DEBUG: Closed separate database session
ğŸ” DEBUG: UserInputManager.add_user_input() returned: True
âœ… DEBUG: Successfully added user input to queue for task 8d71a584-a288-4993-bca2-c445249c7d1a with separate session
ğŸ” DEBUG: After UserInputManager commit - fresh query shows task.user_input_queue = [{'id': '651917af-2af3-433f-83ab-6addefde758c', 'input': 'how many files you have scanned?', 'processed': False, 'timestamp': '2025-10-25T04:49:46.010557'}, {'id': 'f3b346d5-9fc6-43a1-a768-a67484ab8888', 'input': 'is there any test case already there for this function', 'processed': False, 'timestamp': '2025-10-25T04:51:56.462294'}, {'id': 'e39bc76e-1c06-49f2-bbe6-80489d28e140', 'input': 'what is the current status', 'processed': False, 'timestamp': '2025-10-25T13:30:53.515189'}, {'id': 'c85a9e2c-8053-48a3-aa12-562fcdb51a29', 'input': 'Test message processing fix - this should be marked as processed immediately', 'processed': False, 'timestamp': '2025-10-25T13:31:13.899523'}, {'id': '58a16257-c417-42d5-96d8-66a009e0ceac', 'input': 'Mark all previous messages as processed', 'processed': False, 'timestamp': '2025-10-25T13:34:50.439379'}]
ğŸ” DEBUG: About to commit legacy field for task 8d71a584-a288-4993-bca2-c445249c7d1a
âœ… DEBUG: Legacy field commit completed for task 8d71a584-a288-4993-bca2-c445249c7d1a
INFO:     127.0.0.1:53751 - "POST /api/v1/tasks/by-name/add_scene_event_codes_to_stra/set-input HTTP/1.1" 200 OK
INFO:     127.0.0.1:53813 - "POST /api/v1/tasks/by-name/add_scene_event_codes_to_stra/stop HTTP/1.1" 400 Bad Request
